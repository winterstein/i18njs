function I18N(b,c,j){this.lang=b;this.appTag=j?j:false;this.dateFormat=function(i){return i.toLocaleString()};this.numberFormat=function(i){return i.toString()};this.loaded=true;this.en2lang={};this.active(true);if(!c){this.loaded=true;return}if(!c.match(/^\S+$/)){this._parseFile(c)}if(c.charAt(0)==="#"){if(!b){var h=navigator&&(navigator.language||navigator.userLanguage);if(h){this.lang=h.substring(0,2)}else{return}}c="https://i18n.soda.sh/i18n-trans.csv?tag="+escape(c)+"&lang="+escape(this.lang);this.appTag=c}try{var f={async:false,cache:true,success:function(i){this._parseFile(i)}.bind(this),complete:function(){this.loaded=true}.bind(this)};var e=c.indexOf("//");var g=window.location?window.location:"";var a=c.substring(e+2,e+2+g.length);if(e===-1||(g&&a===g)){}else{f.jsonpCallback="_i18nCallback";f.dataType="jsonp"}this.loaded=false;$.ajax(c,f);if(f.dataType==="jsonp"){if(window.SJTest&&SJTest.waitFor){SJTest.waitFor(function(){return this.loaded})}else{console.log("I18N","Using asynchronous loading: The race is on (this is bad, and may produce unpredictable results). Please add SJTest.js for safer loading.")}}}catch(d){console.error(d)}}I18N.prototype.active=function(a){if(a){I18N.active=this}else{if(this===I18N.active){I18N.active=null}}return this===I18N.active};I18N.tr=function(a){if(!I18N.active){new I18N()}return I18N.active.tr(a)};I18N._MARKERCHAR="‚êö";I18N.prototype.add=function(e,h,f){var g=[],a=[];var d=this.canon(e,g);var c=this.canon(h,g,true);var b=this.en2lang[d];if(b&&b!==c){if(typeof(b)==="string"){b=[b]}b.push([e,c,f]);this.en2lang[d]=b}else{this.en2lang[d]=c}};I18N.prototype._parseFile=function(d){var b=d.split(/[\r\n]/);for(var c=0;c<b.length;c++){var a=b[c];if(!a||a.charAt(0)=="#"){continue}var e=a.split("\t");if(e.length<2){continue}this.add(e[0],e[1])}console.log("I18N","loaded",this)};I18N.prototype.tr=function(a){var d=[],c=this.canon(a,d),b=this.en2lang[c];if(b&&typeof(b)!=="string"){b=this._tr2_multi(a,d,b)}if(b){return this.uncanon(b,d)}if(this.loaded&&a){if(this.lang){this.onfail(a,this.lang,c)}}var e=this.uncanon(c,d);return e};I18N.prototype._tr2_multi=function(h,f,i){for(var e=1;e<i.length;e++){if(h===i[e][0]){return i[e][1]}}var a={};for(var d=0;d<f.length;d++){var c=this.categorise(f[d]);if(c){for(p in c){a[p]=c[p]}}}if(a==={}){return i[0]}for(var e=1;e<i.length;e++){var b=i[e][2];if(!b){continue}var g=true;for(p in b){if(a[p]!==b[p]){g=false;break}}if(g){return i[e][1]}}return i[0]};I18N.prototype.categorise=function(a){return false};I18N.prototype.onfail=function(a,c,b){console.warn("I18N","fail ("+c+"): "+a+"	(internal key: "+b+")");if(this.appTag){$.ajax({url:"https://i18n.soda.sh/lg",dataType:"jsonp",data:{tag:this.appTag,msg:c+"\t"+a}});if(window.location.host.indexOf("soda.sh")!=-1){$.get("/lg?tag="+this.appTag+"&msg="+escape(c+"\t"+a))}}};I18N.NUMBER=/[0-9,]+(\.\d+)?/g;I18N.KEEPME=new RegExp(I18N.NUMBER.source+"|{.*?}|\bS+@[a-zA-Z.]+|</?[a-z][a-zA-Z0-9]*[^>]*?>","g");I18N.prototype.canon=function(a,d,c){if(!a){return a}if(d===undefined){d=[]}var b=a.replace(I18N.KEEPME,function(e){if(!c){var f=d.length;d.push(e);return I18N._MARKERCHAR+f}var f=d.indexOf(e);if(f==-1){return e}return I18N._MARKERCHAR+f});return b};I18N.prototype.uncanon=function(b,c){if(!b){return b}var e=b;if(c.length!=0){e=this._uncanon2_pluralise(b,c)}for(var d=0;d<c.length;d++){var a=c[d];a=this._uncanon2_convert(a);e=e.replace(I18N._MARKERCHAR+d,a)}return e};I18N.prototype._uncanon2_convert=function(a){if(this.numberFormat){var c=Number(a);if(!isNaN(c)){return this.numberFormat(a)}}if(this.dateFormat){var b=Date(a);if(!isNaN(b.valueOf())){return this.dateFormat(b)}}if(a.length>1&&a.charAt(0)=="{"&&a.charAt(a.length-1)=="}"){a=a.substring(1,a.length-1)}return a};I18N.prototype._uncanon2_pluralise=function(d,b){var a=null;for(var c=0;c<b.length;c++){var e=""+b[c];if(e.match(I18N.NUMBER)){if(e==="1"||e==="1.0"){a=false}else{a=true}break}}if(a===true){d=d.replace(/(\w)\((\w{1,3})\)/g,"$1$2")}else{if(a===false){d=d.replace(/(\w)\(\w{1,3}\)/g,"$1")}}return d};(function(a){a.fn.tr=function(b){if(!b){b=I18N.active||new I18N()}return this.each(function(){var e=a(this);var c=e.data("i18n-raw");if(!c){c=e.html();e.data("i18n-raw",c)}var d=b.tr(c);e.html(d)})}}(jQuery));