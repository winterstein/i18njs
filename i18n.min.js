function I18N(c,a,d){this.lang=c;this.appTag=d?d:false;this.loaded;this.en2lang={};if(!a){this.loaded=true;return}this.loaded=false;if(a.match(/^\S+$/)){try{$.ajax(a,{async:false,success:this._parseFile});return}catch(b){console.error(b)}}this._parseFile(a)}I18N._MARKERCHAR="‚êö";I18N.prototype.add=function(e,h,f){var g=[],a=[];var d=this.canon(e,g);var c=this.canon(h,g,true);var b=this.en2lang[d];if(b&&b!==c){if(typeof(b)==="string"){b=[b]}b.push([e,c,f]);this.en2lang[d]=b}else{this.en2lang[d]=c}};I18N.prototype._parseFile=function(d){var b=d.split(/[\r\n]/);for(var c=0;c<b.length;c++){var a=b[c];if(!a||a.charAt(0)=="#"){continue}var e=a.split("\t");if(e.length<2){continue}this.add(e[0],e[1])}console.log("I18N","loaded",this);this.loaded=true};I18N.prototype.tr=function(a){var d=[],c=this.canon(a,d),b=this.en2lang[c];if(b&&typeof(b)!=="string"){b=this._tr2_multi(a,d,b)}if(b){return this.uncanon(b,d)}if(this.loaded&&a){var e=this.uncanon(c,d);if(this.lang){this.onfail(a,this.lang,c)}return e}return a};I18N.prototype._tr2_multi=function(h,f,i){for(var e=1;e<i.length;e++){if(h===i[e][0]){return i[e][1]}}var a={};for(var d=0;d<f.length;d++){var c=this.categorise(f[d]);if(c){for(p in c){a[p]=c[p]}}}if(a==={}){return i[0]}for(var e=1;e<i.length;e++){var b=i[e][2];if(!b){continue}var g=true;for(p in b){if(a[p]!==b[p]){g=false;break}}if(g){return i[e][1]}}return i[0]};I18N.prototype.categorise=function(a){return false};I18N.prototype.onfail=function(a,c,b){console.warn("I18N","fail ("+c+"): "+a+"	(internal key: "+b+")");if(this.appTag){$.post("https://i18n.soda.sh/lg",{tags:"tr_"+this.appTag,msg:c+"\t"+a})}};I18N.NUMBER=/[0-9,]+(\.\d+)?/g;I18N.KEEPME=new RegExp(I18N.NUMBER.source+"|{.*?}|\bS+@[a-zA-Z.]+|</?[a-z][a-zA-Z0-9]*[^>]*?>","g");I18N.prototype.canon=function(a,d,c){if(!a){return a}if(d===undefined){d=[]}var b=a.replace(I18N.KEEPME,function(e){if(!c){var f=d.length;d.push(e);return I18N._MARKERCHAR+f}var f=d.indexOf(e);if(f==-1){return e}return I18N._MARKERCHAR+f});return b};I18N.prototype.uncanon=function(b,c){if(!b){return b}var e=b;if(c.length!=0){e=this._uncanon2_pluralise(b,c)}for(var d=0;d<c.length;d++){var a=""+c[d];if(a.length>1&&a.charAt(0)=="{"&&a.charAt(a.length-1)=="}"){a=a.substring(1,a.length-1)}e=e.replace(I18N._MARKERCHAR+d,a)}return e};I18N.prototype._uncanon2_pluralise=function(d,b){var a=null;for(var c=0;c<b.length;c++){var e=""+b[c];if(e.match(I18N.NUMBER)){if(e==="1"||e==="1.0"){a=false}else{a=true}break}}if(a===true){d=d.replace(/(\w)\((\w{1,3})\)/g,"$1$2")}else{if(a===false){d=d.replace(/(\w)\(\w{1,3}\)/g,"$1")}}return d};